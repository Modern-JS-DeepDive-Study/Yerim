# 38. 브라우저의 렌더링 과정
## 브라우저의 렌더링 과정
1. 렌더링에 필요한 리소스 요청(HTML, CSS, JS, IMG 등) 및 서버 응답 
2. 렌더링 엔진이 HTML은 DOM으로 CSS는 CSSOM으로 파싱 및 생성하여 렌더 트리 형성
3. 렌더링 엔진이 자바스크립트 파싱하여 AST 생성 및 바이트 코드 변환 실행, 자바스크립트는 DOM API를 통해 DOM이나 CSSOM을 변경할 수 있고, 이후 다시 렌더 트리로 결합
4. 렌더 트리 기반으로 HTML 요소의 레이아웃을 계산하고 브라우저 화면에 HTML 요소 페인팅

## 브라우저의 기능
✅ 리소스를 서버에 요청하고 서버로부터 응답 받아 브라우저에 시각적으로 렌더링 \
✅ URL 입력 -> DNS를 통해 IP 주소로 변환 -> IP 주소를 갖는 서버에게 요청

## HTTP1.1과 HTTP2.0
> ✅ HTTP
    > - 웹에서 브라우저와 서버가 통신하기 위한 프로토콜 (규약)

> ✅ HTTP1.1
    > - 커넥션 당 하나의 요청과 응답만 처리
    > - 리소스 요청이 개별적으로 전송되고 응답도 개별적으로 전송되지만 요청할 리소스의 개수에 비례하여 응답시간도 증가한다는 단점

> ✅ HTTP2.0
    > - 커넥션당 여러 대의 요청과 응답, 다중 요청 / 응답이 가능
    > - 여러 리소스의 동시 전송이 가능

## 순서
1. HTML파싱과 DOM 생성
    - DOM은 HTML 문서를 파싱한 결과물
2. CSS 파싱과 CSSOM 생성
    - DOM을 생성해 나가다가 CSS를 로드하는 link 태그나 style 태그를 만나면 DOM을 일시 중단
    - CSS 파싱을 완료하면 HTML파싱이 중단된 지점부터 다시 HTML을 파싱하기 시작하여 DOM 생성 재개
3. 렌더 트리 생성
    - DOM과 CSSOM은 렌더링을 위해 렌더 트리로 결합
4. 자바스크립트의 파싱과 실행
    - 자바스크립트 엔진이 자바스크립트를 해석하여 AST(추상적 구문 트리) 생성
5. 리플로우와 리페인트
    - 변경된 DOM과 CSSOM은 다시 렌더 트리로 결합(리플로우)되고 변경된 렌더 트리를 기반으로 레이아웃과 페인트 과정(리페인트)을 거쳐 브라우저에 다시 렌더링
6. 자바스크립트 파싱에 의한 HTML 파싱 중단
    - 직렬적이며 동기적으로 파싱을 수행
    - script 태그의 위치가 중요한 의미

## async/defer
- src를 통해 외부 자바스크립트 파일을 로드하는 경우에만 사용
### async
- HTML 파싱과 외부 자바스크립트 파일의 로드가 비동기적으로 동시에 진행
- **파싱과 실행은 자바스크립트 파일의 로드가 완료된 직후 실행**, HTML 파싱은 중단
- 여러개의 script를 사용하면 로드가 완료된 js부터 실행하기 때문에 순서 보장X
### defer
- HTML 파싱과 외부 자바스크립트 파일의 로드가 비동기적으로 동시에 진행
- **DOM 생성이 완료된 직후** 자바스크립트의 파싱과 실행이 진행

# 39.DOM
DOM: HTML 문서의 계층적 구조와 정보를 표현하며 이를 제어할 수 있는 API, 즉 프로퍼티와 메서드를 제공하는 트리 구조
## 노트 타입
1. 문서 노드 (document node)
    - 최상위 루트 노드
    - 하나의 전역 객체 window 공유
2. 요소 노드 (element node)
3. 어트리뷰트 노드 (attribute node)
4. 텍스트 노드 (text node) 
    - DOM 트리의 최종단

## HTML Collection과 NodeList
- 모두 유사 배열 객체이면서 이터러블
- 노드 객체의 상태 변화를 실시간으로 반영하는 **살아있는 객체**
- **HTML은 언제나 live 객체로 동작하지만, NodeList는 대부분의 경우 노드 객체의 상태 변화를 실시간으로 반영하지 않고 과거의 정적 상태를 유지하는 non-live 객체로 동작**
- childNode가 반환하는 NodeList 객체는 live 객체로 동작

### innerHTML을 사용할 때 유의할 점
- 마크업 내에 악성 코드가 포함되어 있다면 파싱 과정에서 실행 가능성이 있기 때문에 크로스 사이트 스크립팅 공격에 취약하기 때문에 위험